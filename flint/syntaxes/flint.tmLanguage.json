{
  "$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
  "name": "Flint",
  "patterns": [
    { "include": "#keywords" },
    { "include": "#identifiers" },
    { "include": "#comments" },
    { "include": "#symbols" },
    { "include": "#strings" },
    { "include": "#numbers" },
    { "include": "#punctuation" }
  ],
  "repository": {
    "keywords": {
      "patterns": [
        { "name": "keyword.control", "match": "\\b(if|else|do|while|for|in|switch|return|break|continue|sync|async|spawn|lock)\\b" },
        { "name": "keyword.exception", "match": "\\b(throw|catch)\\b"},
        { "name": "keyword.preproc", "match": "\\b(use|as|type|requires|extends|link|hook)\\b"},
        { "name": "keyword.declaration", "match": "\\b(def|data|func|entity|enum|variant|error|test|extern|export)\\b" },
        { "name": "storage.modifier", "match": "\\b(const|shared|persistent|mut)\\b" },
        { "name": "storage.type", "match": "\\b(str|fn|bp|void|bool|bool8|anyerror|u8|u16|u32|u64|i8|i16|i32|i64|i32x2|i32x3|i32x4|i32x8|i64x2|i64x3|i64x4|u32x2|u32x3|u32x4|u32x8|u64x2|u64x3|u64x4|f32|f64|f32x2|f32x3|f32x4|f32x8|f64x2|f64x3|f64x4)\\b" },
        { "name": "constant.language", "match": "\\b(true|false|none)\\b" },
        { "name": "keyword", "match": "\\b(and|or|not)\\b" }
      ]
    },
    "strings": {
      "patterns": [
        {
          "name": "string.quoted.single",
          "begin": "'",
          "end": "'",
          "patterns": [
            { "name": "constant.character.escape", "match": "\\\\." }
          ]
        },
        {
          "name": "string.quoted.double",
          "begin": "\\$\"",
          "end": "\"",
          "patterns": [
            { "name": "constant.character.escape", "match": "\\\\." },
            { 
              "begin": "\\{",
              "beginCaptures": {
                "0": { "name": "punctuation.section.embedded.begin.flint" }
              },
              "end": "\\}",
              "endCaptures": {
                "0": { "name": "punctuation.section.embedded.end.flint" }
              },
              "contentName": "meta.embedded.line.flint",
              "patterns": [
                { "include": "#keywords" },
                { "include": "#numbers" },
                { "include": "#identifiers" },
                { "include": "#punctuation" },
                { "include": "#symbols" },
                { "include": "#comments" },
                { "include": "#strings" }
              ]
            }
          ]
        },
        {
          "name": "string.quoted.double",
          "begin": "\"",
          "end": "\"",
          "patterns": [
            {
              "name": "constant.character.escape",
              "match": "\\\\."
            }
          ]
        }
      ]
    },
    "comments": {
      "patterns": [
        { 
          "name": "comment.line.double-slash", 
          "begin": "//", 
          "end": "$",
          "patterns": [
            { "name": "keyword.other.documentation", "match": "\\b(TODO|FIXME|NOTE|WARNING)\\b" },
            { "name": "entity.other.attribute-name", "match": "@[A-Za-z]*" }
          ]
        },
        { 
          "name": "comment.block", 
          "begin": "/\\*", 
          "end": "\\*/",
          "patterns": [
            { "name": "keyword.other.documentation", "match": "\\b(TODO|FIXME|NOTE|WARNING)\\b" },
            { "name": "entity.other.attribute-name", "match": "@[A-Za-z]*" }
          ]
        },
        { "name": "comment.line.number-sign", "match": "#[^\n]*" }
      ]
    },
    "symbols": {
      "patterns": [
        { "name": "punctuation.separator", "match": ",|;|:|\\." },
        { "name": "keyword.operator", "match": "\\+\\+|--|==|!=|<=|>=|\\+=|-=|\\*=|/=|:=|=|<|>|::|\\+|-|\\*|&|/|!\\.|!|\\*|%|\\|>|\\?\\.|\\?\\?|\\?(?=\\()"},
        { "name": "constant.other.tuple-access", "match": "\\$\\d+" },
        { "name": "storage.type.optional", "match": "\\?" }
      ]
    },
    "identifiers": {
      "patterns": [
        { "name": "constant.other", "match": "\\b[A-Z_][A-Z0-9_]*\\b" },
        { "name": "entity.name.type", "match": "\\b[A-Z][a-zA-Z0-9_]*\\b" },
        { "name": "entity.name.function", "match": "\\b[a-z_][a-zA-Z0-9_]*(?=\\()" },
        { "name": "variable.other", "match": "\\b[a-z_][a-zA-Z0-9_]*\\b" }
      ]
    },
    "numbers": {
      "name": "constant.numeric",
      "match": "\\b\\d+(_\\d+)*(\\.\\d+(_\\d+)*)?\\b"
    },
    "punctuation": {
      "name": "punctuation.brackets",
      "match": "[(){}\\[\\]]"
    }
  },
  "scopeName": "source.flint"
}
